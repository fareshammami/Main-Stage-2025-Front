<div class="user-stream-container">

  <!-- Header -->
  <div class="user-header-state-card">
    <div class="user-info">
      <h2>âœ¨ {{ username || userId }}</h2>
    </div>
    <div class="user-totals" *ngIf="netTotal !== null" [class.updated]="totalsUpdated">
      <div class="totals-label">ğŸ’° Current Amount</div>
      <div class="totals-value">ğŸ’° {{ netTotal.toFixed(2) }}</div>
    </div>
  </div>

  <!-- Messages -->
  <div *ngIf="errorMessage" class="message error">{{ errorMessage }}</div>
  <div *ngIf="loading" class="loading">Chargement...</div>

  <hr />

  <!-- Events Table -->
  <h3>Handled Events</h3>
  <div class="table-responsive">
    <table>
      <thead>
        <tr>
          <th>Type of Event</th>
          <th>Amount</th>
          <th>Created At</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let event of events" [class.recent]="isRecentEvent(event)">
          <td>{{ event.eventType }}</td>
          <td>{{ getAmount(event) }}</td>
          <td>
            <ng-container *ngIf="event.createdAt !== 'N/A'; else noDate">
              {{ event.createdAt | date:'short' }}
            </ng-container>
            <ng-template #noDate>
              <span class="badge na">N/A</span>
            </ng-template>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="pagination">
    <button (click)="prevPage()" [disabled]="currentPage===0">PrÃ©cÃ©dent</button>
    <span>Page {{ currentPage + 1 }}</span>
    <button (click)="nextPage()" [disabled]="events.length < pageSize">Suivant</button>
  </div>

</div>
